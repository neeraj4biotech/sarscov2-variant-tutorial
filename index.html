<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SARS-CoV-2 Variant Calling Tutorial ‚Äî ICE-Cloud</title>

<!-- ============================= -->
<!--  PREMIUM DOC PORTAL UI (H2)    -->
<!--  Dark/Light Mode + Lunr Search -->
<!--  Prism Syntax Highlighting     -->
<!-- ============================= -->

<!-- Prism.js for syntax highlighting -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>

<!-- Lunr.js for fuzzy search -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js"></script>

<style>
/* =============================
   GLOBAL THEME + RESET
   ============================= */
:root {
  --accent: #0b63a5;
  --accent-dark: #083d7a;
  --bg: #ffffff;
  --text: #1a1a1a;
  --muted: #6b7280;
  --card-bg: #ffffff;
  --border: #e6eef6;
}
[data-theme="dark"] {
  --bg: #0a0f14;
  --text: #e6edf3;
  --card-bg: #111a21;
  --border: #1f2a33;
}
body {
  margin: 0;
  background: var(--bg);
  color: var(--text);
  font-family: Inter, system-ui, sans-serif;
  line-height: 1.6;
}

/* =============================
   HEADER (H2 DOC STYLE)
   ============================= */
header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 24px;
  background: var(--card-bg);
  border-bottom: 1px solid var(--border);
  position: sticky;
  top: 0;
  z-index: 1000;
}
header .left-group {
  display: flex;
  align-items: center;
  gap: 14px;
}
#searchBox {
  padding: 7px 10px;
  width: 280px;
  border: 1px solid var(--border);
  border-radius: 6px;
  background: var(--bg);
  color: var(--text);
}
.theme-toggle {
  cursor: pointer;
  padding: 6px 10px;
  border-radius: 6px;
  background: var(--accent);
  color: white;
}

/* =============================
   LAYOUT GRID
   ============================= */
.container {
  display: grid;
  grid-template-columns: 270px auto;
  min-height: 100vh;
}
nav {
  border-right: 1px solid var(--border);
  background: var(--card-bg);
  padding: 20px;
  height: calc(100vh - 60px);
  overflow-y: auto;
  position: sticky;
  top: 60px;
}
nav h3 {
  margin: 10px 0;
  cursor: pointer;
  font-size: 15px;
}
nav ul {
  list-style: none;
  padding-left: 15px;
  display: none;
}
nav ul li {
  margin: 4px 0;
}
nav a {
  text-decoration: none;
  color: var(--accent);
  font-size: 14px;
}
nav a.active-link {
  font-weight: bold;
  text-decoration: underline;
}

main {
  padding: 32px;
  max-width: 1000px;
}
h2.section-title {
  margin-top: 0;
}
.card {
  background: var(--card-bg);
  border: 1px solid var(--border);
  padding: 12px;
  border-radius: 6px;
  margin: 12px 0;
}
.cmd-wrap {
  position: relative;
}
.copy-btn {
  position: absolute;
  top: 6px;
  right: 6px;
  padding: 4px 10px;
  background: var(--accent);
  border: none;
  border-radius: 5px;
  color: white;
  cursor: pointer;
}

/* =============================
   WORKFLOW DIAGRAM
   ============================= */
.workflow-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  margin: 20px 0;
}
.workflow-card {
  padding: 12px 18px;
  border-radius: 8px;
  border: 1px solid var(--border);
  background: var(--card-bg);
  text-align: center;
}
.workflow-arrow {
  font-size: 26px;
  color: var(--accent);
}
</style>
</head>

<body>

<!-- =============================
     TOP HEADER (H2 STYLE)
============================== -->
<header>
  <div class="left-group">
    <img src="https://img.icons8.com/color/48/000000/coronavirus.png" width="32" />
    <h2>SARS-CoV-2 Variant Calling Tutorial</h2>
  </div>
  <div class="right-group">
    <input id="searchBox" placeholder="Search tutorial..." />
    <button class="theme-toggle" id="themeToggle">üåô</button>
  </div>
</header>

<div class="container">

<!-- =============================
     COLLAPSIBLE SIDEBAR (SB-1)
============================== -->
<nav>
  <h3 data-target="intro-menu">Introduction</h3>
  <ul id="intro-menu"><li><a href="#intro">Overview</a></li></ul>

  <h3 data-target="wf-menu">Workflow Diagram</h3>
  <ul id="wf-menu"><li><a href="#workflow">Pipeline Overview</a></li></ul>

  <h3 data-target="step1-menu">Step 1 ‚Äî Data Preparation</h3>
  <ul id="step1-menu">
    <li><a href="#step1-download">Download</a></li>
    <li><a href="#step1-fq">FASTQ Conversion</a></li>
    <li><a href="#step1-gzip">Compression</a></li>
  </ul>

  <h3 data-target="step2-menu">Step 2 ‚Äî FastQC</h3>
  <ul id="step2-menu"><li><a href="#step2">Run FastQC</a></li></ul>

  <h3 data-target="step3-menu">Step 3 ‚Äî Trimming</h3>
  <ul id="step3-menu"><li><a href="#step3">Trim Reads</a></li></ul>

  <h3 data-target="step4-menu">Step 4 ‚Äî Alignment</h3>
  <ul id="step4-menu">
    <li><a href="#step4-index">Index Reference</a></li>
    <li><a href="#step4-mem">bwa mem</a></li>
  </ul>

  <h3 data-target="step5-menu">Step 5 ‚Äî BAM Processing</h3>
  <ul id="step5-menu">
    <li><a href="#step5-sam">SAM‚ÜíBAM</a></li>
    <li><a href="#step5-sort">Sorting</a></li>
    <li><a href="#step5-index">Indexing</a></li>
  </ul>

  <h3 data-target="step6-menu">Step 6 ‚Äî Variant Calling</h3>
  <ul id="step6-menu">
    <li><a href="#step6-mpileup">mpileup</a></li>
    <li><a href="#step6-call">Call Variants</a></li>
  </ul>

  <h3 data-target="step7-menu">Step 7 ‚Äî Annotation</h3>
  <ul id="step7-menu">
    <li><a href="#step7-build">Build DB</a></li>
    <li><a href="#step7-ann">Annotate VCF</a></li>
  </ul>

  <h3 data-target="ref-menu">Documentation</h3>
  <ul id="ref-menu">
    <li><a href="#references">Tool Docs</a></li>
  </ul>
</nav>

<!-- =============================
     MAIN CONTENT
============================== -->
<main>
<section id="intro">
  <h2 class="section-title">Introduction</h2>
  <p>This tutorial explains a complete SARS-CoV-2 variant calling workflow using FastQC, Trim Galore, BWA, SAMtools, BCFtools, and SnpEff.</p>
</section>

<section id="workflow">
  <h2 class="section-title">Workflow Diagram</h2>
  <div class="workflow-row">
    <div class="workflow-card">üì•<br>Download</div>
    <div class="workflow-arrow">‚ûú</div>
    <div class="workflow-card">üîç<br>FastQC</div>
    <div class="workflow-arrow">‚ûú</div>
    <div class="workflow-card">‚úÇÔ∏è<br>Trim</div>
    <div class="workflow-arrow">‚ûú</div>
    <div class="workflow-card">üß¨<br>BWA</div>
    <div class="workflow-arrow">‚ûú</div>
    <div class="workflow-card">üßπ<br>SAMtools</div>
    <div class="workflow-arrow">‚ûú</div>
    <div class="workflow-card">üß™<br>BCFtools</div>
    <div class="workflow-arrow">‚ûú</div>
    <div class="workflow-card">üß†<br>SnpEff</div>
  </div>
</section>

<section id="objective">
  <h2 class="section-title">Objective</h2>
  <p>Perform quality control, trimming, reference alignment, variant calling, and annotation for SARS-CoV-2.</p>
</section>

<!-- =============================
     STEP 1
============================== -->
<section id="step1">
  <h2 class="section-title">Step 1 ‚Äî Data Preparation</h2>

  <h3 id="step1-download">Download</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c1">Copy</button>
  <pre id="c1"><code class="language-bash">prefetch SRR15571424</code></pre></div>

  <h3 id="step1-fq">Convert to FASTQ</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c2">Copy</button>
  <pre id="c2"><code class="language-bash">fasterq-dump SRR15571424 -S -e 2</code></pre></div>

  <h3 id="step1-gzip">Compress FASTQ</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c3">Copy</button>
  <pre id="c3"><code class="language-bash">gzip SRR15571424_1.fastq
gzip SRR15571424_2.fastq</code></pre></div>
</section>

<!-- =============================
     STEP 2
============================== -->
<section id="step2">
  <h2 class="section-title">Step 2 ‚Äî Quality Check (FastQC)</h2>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c4">Copy</button>
  <pre id="c4"><code class="language-bash">fastqc *.fastq.gz --threads 4</code></pre></div>
</section>

<!-- =============================
     STEP 3
============================== -->
<section id="step3">
  <h2 class="section-title">Step 3 ‚Äî Read Trimming</h2>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c5">Copy</button>
  <pre id="c5"><code class="language-bash">trim_galore --paired *.fastq.gz</code></pre></div>
</section>

<!-- =============================
     STEP 4
============================== -->
<section id="step4">
  <h2 class="section-title">Step 4 ‚Äî Alignment (BWA)</h2>

  <h3 id="step4-index">Create Index</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c6">Copy</button>
  <pre id="c6"><code class="language-bash">bwa index MN908947.3.fna</code></pre></div>

  <h3 id="step4-mem">Run bwa mem</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c7">Copy</button>
  <pre id="c7"><code class="language-bash">bwa mem MN908947.3.fna reads_1.fq.gz reads_2.fq.gz > aln.sam</code></pre></div>
</section>

<!-- =============================
     STEP 5
============================== -->
<section id="step5">
  <h2 class="section-title">Step 5 ‚Äî BAM Processing (SAMtools)</h2>

  <h3 id="step5-sam">SAM ‚Üí BAM</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c8">Copy</button>
  <pre id="c8"><code class="language-bash">samtools view -bS aln.sam > aln.bam</code></pre></div>

  <h3 id="step5-sort">Sorting</h3>
  <
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SARS-CoV-2 Variant Calling Tutorial ‚Äî ICE-Cloud</title>

<!-- ============================= -->
<!--  PREMIUM DOC PORTAL UI (H2)    -->
<!--  Dark/Light Mode + Lunr Search -->
<!--  Prism Syntax Highlighting     -->
<!-- ============================= -->

<!-- Prism.js for syntax highlighting -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>

<!-- Lunr.js for fuzzy search -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js"></script>

<style>
/* =============================
   GLOBAL THEME + RESET
   ============================= */
:root {
  --accent: #0b63a5;
  --accent-dark: #083d7a;
  --bg: #ffffff;
  --text: #1a1a1a;
  --muted: #6b7280;
  --card-bg: #ffffff;
  --border: #e6eef6;
}
[data-theme="dark"] {
  --bg: #0a0f14;
  --text: #e6edf3;
  --card-bg: #111a21;
  --border: #1f2a33;
}
body {
  margin: 0;
  background: var(--bg);
  color: var(--text);
  font-family: Inter, system-ui, sans-serif;
  line-height: 1.6;
}

/* =============================
   HEADER (H2 DOC STYLE)
   ============================= */
header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 24px;
  background: var(--card-bg);
  border-bottom: 1px solid var(--border);
  position: sticky;
  top: 0;
  z-index: 1000;
}
header .left-group {
  display: flex;
  align-items: center;
  gap: 14px;
}
#searchBox {
  padding: 7px 10px;
  width: 280px;
  border: 1px solid var(--border);
  border-radius: 6px;
  background: var(--bg);
  color: var(--text);
}
.theme-toggle {
  cursor: pointer;
  padding: 6px 10px;
  border-radius: 6px;
  background: var(--accent);
  color: white;
}

/* =============================
   LAYOUT GRID
   ============================= */
.container {
  display: grid;
  grid-template-columns: 270px auto;
  min-height: 100vh;
}
nav {
  border-right: 1px solid var(--border);
  background: var(--card-bg);
  padding: 20px;
  height: calc(100vh - 60px);
  overflow-y: auto;
  position: sticky;
  top: 60px;
}
nav h3 {
  margin: 10px 0;
  cursor: pointer;
  font-size: 15px;
}
nav ul {
  list-style: none;
  padding-left: 15px;
  display: none;
}
nav ul li {
  margin: 4px 0;
}
nav a {
  text-decoration: none;
  color: var(--accent);
  font-size: 14px;
}
nav a.active-link {
  font-weight: bold;
  text-decoration: underline;
}

main {
  padding: 32px;
  max-width: 1000px;
}
h2.section-title {
  margin-top: 0;
}
.card {
  background: var(--card-bg);
  border: 1px solid var(--border);
  padding: 12px;
  border-radius: 6px;
  margin: 12px 0;
}
.cmd-wrap {
  position: relative;
}
.copy-btn {
  position: absolute;
  top: 6px;
  right: 6px;
  padding: 4px 10px;
  background: var(--accent);
  border: none;
  border-radius: 5px;
  color: white;
  cursor: pointer;
}

/* =============================
   WORKFLOW DIAGRAM
   ============================= */
.workflow-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  margin: 20px 0;
}
.workflow-card {
  padding: 12px 18px;
  border-radius: 8px;
  border: 1px solid var(--border);
  background: var(--card-bg);
  text-align: center;
}
.workflow-arrow {
  font-size: 26px;
  color: var(--accent);
}
</style>
</head>

<body>

<!-- =============================
     TOP HEADER (H2 STYLE)
============================== -->
<header>
  <div class="left-group">
    <img src="https://img.icons8.com/color/48/000000/coronavirus.png" width="32" />
    <h2>SARS-CoV-2 Variant Calling Tutorial</h2>
  </div>
  <div class="right-group">
    <input id="searchBox" placeholder="Search tutorial..." />
    <button class="theme-toggle" id="themeToggle">üåô</button>
  </div>
</header>

<div class="container">

<!-- =============================
     COLLAPSIBLE SIDEBAR (SB-1)
============================== -->
<nav>
  <h3 data-target="intro-menu">Introduction</h3>
  <ul id="intro-menu"><li><a href="#intro">Overview</a></li></ul>

  <h3 data-target="wf-menu">Workflow Diagram</h3>
  <ul id="wf-menu"><li><a href="#workflow">Pipeline Overview</a></li></ul>

  <h3 data-target="step1-menu">Step 1 ‚Äî Data Preparation</h3>
  <ul id="step1-menu">
    <li><a href="#step1-download">Download</a></li>
    <li><a href="#step1-fq">FASTQ Conversion</a></li>
    <li><a href="#step1-gzip">Compression</a></li>
  </ul>

  <h3 data-target="step2-menu">Step 2 ‚Äî FastQC</h3>
  <ul id="step2-menu"><li><a href="#step2">Run FastQC</a></li></ul>

  <h3 data-target="step3-menu">Step 3 ‚Äî Trimming</h3>
  <ul id="step3-menu"><li><a href="#step3">Trim Reads</a></li></ul>

  <h3 data-target="step4-menu">Step 4 ‚Äî Alignment</h3>
  <ul id="step4-menu">
    <li><a href="#step4-index">Index Reference</a></li>
    <li><a href="#step4-mem">bwa mem</a></li>
  </ul>

  <h3 data-target="step5-menu">Step 5 ‚Äî BAM Processing</h3>
  <ul id="step5-menu">
    <li><a href="#step5-sam">SAM‚ÜíBAM</a></li>
    <li><a href="#step5-sort">Sorting</a></li>
    <li><a href="#step5-index">Indexing</a></li>
  </ul>

  <h3 data-target="step6-menu">Step 6 ‚Äî Variant Calling</h3>
  <ul id="step6-menu">
    <li><a href="#step6-mpileup">mpileup</a></li>
    <li><a href="#step6-call">Call Variants</a></li>
  </ul>

  <h3 data-target="step7-menu">Step 7 ‚Äî Annotation</h3>
  <ul id="step7-menu">
    <li><a href="#step7-build">Build DB</a></li>
    <li><a href="#step7-ann">Annotate VCF</a></li>
  </ul>

  <h3 data-target="ref-menu">Documentation</h3>
  <ul id="ref-menu">
    <li><a href="#references">Tool Docs</a></li>
  </ul>
</nav>

<!-- =============================
     MAIN CONTENT
============================== -->
<main>
<section id="intro">
  <h2 class="section-title">Introduction</h2>
  <p>This tutorial explains a complete SARS-CoV-2 variant calling workflow using FastQC, Trim Galore, BWA, SAMtools, BCFtools, and SnpEff.</p>
</section>

<section id="workflow">
  <h2 class="section-title">Workflow Diagram</h2>
  <div class="workflow-row">
    <div class="workflow-card">üì•<br>Download</div>
    <div class="workflow-arrow">‚ûú</div>
    <div class="workflow-card">üîç<br>FastQC</div>
    <div class="workflow-arrow">‚ûú</div>
    <div class="workflow-card">‚úÇÔ∏è<br>Trim</div>
    <div class="workflow-arrow">‚ûú</div>
    <div class="workflow-card">üß¨<br>BWA</div>
    <div class="workflow-arrow">‚ûú</div>
    <div class="workflow-card">üßπ<br>SAMtools</div>
    <div class="workflow-arrow">‚ûú</div>
    <div class="workflow-card">üß™<br>BCFtools</div>
    <div class="workflow-arrow">‚ûú</div>
    <div class="workflow-card">üß†<br>SnpEff</div>
  </div>
</section>

<section id="objective">
  <h2 class="section-title">Objective</h2>
  <p>Perform quality control, trimming, reference alignment, variant calling, and annotation for SARS-CoV-2.</p>
</section>

<!-- =============================
     STEP 1
============================== -->
<section id="step1">
  <h2 class="section-title">Step 1 ‚Äî Data Preparation</h2>

  <h3 id="step1-download">Download</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c1">Copy</button>
  <pre id="c1"><code class="language-bash">prefetch SRR15571424</code></pre></div>

  <h3 id="step1-fq">Convert to FASTQ</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c2">Copy</button>
  <pre id="c2"><code class="language-bash">fasterq-dump SRR15571424 -S -e 2</code></pre></div>

  <h3 id="step1-gzip">Compress FASTQ</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c3">Copy</button>
  <pre id="c3"><code class="language-bash">gzip SRR15571424_1.fastq
gzip SRR15571424_2.fastq</code></pre></div>
</section>

<!-- =============================
     STEP 2
============================== -->
<section id="step2">
  <h2 class="section-title">Step 2 ‚Äî Quality Check (FastQC)</h2>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c4">Copy</button>
  <pre id="c4"><code class="language-bash">fastqc *.fastq.gz --threads 4</code></pre></div>
</section>

<!-- =============================
     STEP 3
============================== -->
<section id="step3">
  <h2 class="section-title">Step 3 ‚Äî Read Trimming</h2>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c5">Copy</button>
  <pre id="c5"><code class="language-bash">trim_galore --paired *.fastq.gz</code></pre></div>
</section>

<!-- =============================
     STEP 4
============================== -->
<section id="step4">
  <h2 class="section-title">Step 4 ‚Äî Alignment (BWA)</h2>

  <h3 id="step4-index">Create Index</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c6">Copy</button>
  <pre id="c6"><code class="language-bash">bwa index MN908947.3.fna</code></pre></div>

  <h3 id="step4-mem">Run bwa mem</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c7">Copy</button>
  <pre id="c7"><code class="language-bash">bwa mem MN908947.3.fna reads_1.fq.gz reads_2.fq.gz > aln.sam</code></pre></div>
</section>

<!-- =============================
     STEP 5
============================== -->
<section id="step5">
  <h2 class="section-title">Step 5 ‚Äî BAM Processing (SAMtools)</h2>

  <h3 id="step5-sam">SAM ‚Üí BAM</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c8">Copy</button>
  <pre id="c8"><code class="language-bash">samtools view -bS aln.sam > aln.bam</code></pre></div>

  <h3 id="step5-sort">Sorting</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c9">Copy</button>
  <pre id="c9"><code class="language-bash">samtools sort aln.bam -o aln.sorted.bam</code></pre></div>

  <h3 id="step5-index">Indexing</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c10">Copy</button>
  <pre id="c10"><code class="language-bash">samtools index aln.sorted.bam</code></pre></div>
</section>

<!-- =============================
     STEP 6
============================== -->
<section id="step6">
  <h2 class="section-title">Step 6 ‚Äî Variant Calling (BCFtools)</h2>

  <h3 id="step6-mpileup">mpileup</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c11">Copy</button>
  <pre id="c11"><code class="language-bash">bcftools mpileup -f MN908947.3.fna aln.sorted.bam -Ou > raw.bcf</code></pre></div>

  <h3 id="step6-call">Call Variants</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c12">Copy</button>
  <pre id="c12"><code class="language-bash">bcftools call -mv -Ov --ploidy 1 raw.bcf > variants.vcf</code></pre></div>
</section>

<!-- =============================
     STEP 7
============================== -->
<section id="step7">
  <h2 class="section-title">Step 7 ‚Äî Annotation (SnpEff)</h2>

  <h3 id="step7-build">Build Database</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c13">Copy</button>
  <pre id="c13"><code class="language-bash">/snpEff/scripts/buildDbNcbi.sh MN908947.3</code></pre></div>

  <h3 id="step7-ann">Annotate VCF</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c14">Copy</button>
  <pre id="c14"><code class="language-bash">java -jar snpEff.jar ann MN908947.3 variants.vcf > annotated.vcf</code></pre></div>

</section>

<!-- =============================
     REFERENCES
============================== -->
<section id="references">
  <h2 class="section-title">Tool Documentation & References</h2>
  <ul>
    <li><a href="https://github.com/ncbi/sra-tools" target="_blank">SRA Toolkit</a></li>
    <li><a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/" target="_blank">FastQC</a></li>
    <li><a href="https://www.bioinformatics.babraham.ac.uk/projects/trim_galore/" target="_blank">Trim Galore</a></li>
    <li><a href="https://github.com/lh3/bwa" target="_blank">BWA</a></li>
    <li><a href="https://www.htslib.org/" target="_blank">SAMtools</a></li>
    <li><a href="https://samtools.github.io/bcftools/" target="_blank">BCFtools</a></li>
    <li><a href="https://pcingola.github.io/SnpEff/" target="_blank">SnpEff</a></li>
  </ul>
</section>

<!-- =============================
     END SECTION + FOOTER PLACEHOLDER
============================== -->
<section id="end">
  <h2 class="section-title">End of Tutorial</h2>
  <p>You have completed the SARS-CoV-2 Variant Calling Tutorial.</p>
</section>

<footer>
  <p>Created for ICE-Cloud users.</p>
</footer>

<!-- JS placeholders for next step (theme toggle, copy, sidebar, search) -->
<script>
// Search Mode: SR-1 (minimal highlight)
// Functions will be injected in next update.
</script>

<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SARS-CoV-2 Variant Calling Tutorial ‚Äî ICE-Cloud</title>

<!-- ============================= -->
<!--  PREMIUM DOC PORTAL UI (H2)    -->
<!--  Dark/Light Mode + Lunr Search -->
<!--  Prism Syntax Highlighting     -->
<!-- ============================= -->

<!-- Prism.js for syntax highlighting -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>

<!-- Lunr.js for fuzzy search -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js"></script>

<style>
/* =============================
   GLOBAL THEME + RESET
   ============================= */
:root {
  --accent: #0b63a5;
  --accent-dark: #083d7a;
  --bg: #ffffff;
  --text: #1a1a1a;
  --muted: #6b7280;
  --card-bg: #ffffff;
  --border: #e6eef6;
}
[data-theme="dark"] {
  --bg: #0a0f14;
  --text: #e6edf3;
  --card-bg: #111a21;
  --border: #1f2a33;
}
body {
  margin: 0;
  background: var(--bg);
  color: var(--text);
  font-family: Inter, system-ui, sans-serif;
  line-height: 1.6;
}

/* =============================
   HEADER (H2 DOC STYLE)
   ============================= */
header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 24px;
  background: var(--card-bg);
  border-bottom: 1px solid var(--border);
  position: sticky;
  top: 0;
  z-index: 1000;
}
header .left-group {
  display: flex;
  align-items: center;
  gap: 14px;
}
#searchBox {
  padding: 7px 10px;
  width: 280px;
  border: 1px solid var(--border);
  border-radius: 6px;
  background: var(--bg);
  color: var(--text);
}
.theme-toggle {
  cursor: pointer;
  padding: 6px 10px;
  border-radius: 6px;
  background: var(--accent);
  color: white;
}

/* =============================
   LAYOUT GRID
   ============================= */
.container {
  display: grid;
  grid-template-columns: 270px auto;
  min-height: 100vh;
}
nav {
  border-right: 1px solid var(--border);
  background: var(--card-bg);
  padding: 20px;
  height: calc(100vh - 60px);
  overflow-y: auto;
  position: sticky;
  top: 60px;
}
nav h3 {
  margin: 10px 0;
  cursor: pointer;
  font-size: 15px;
}
nav ul {
  list-style: none;
  padding-left: 15px;
  display: none;
}
nav ul li {
  margin: 4px 0;
}
nav a {
  text-decoration: none;
  color: var(--accent);
  font-size: 14px;
}
nav a.active-link {
  font-weight: bold;
  text-decoration: underline;
}

main {
  padding: 32px;
  max-width: 1000px;
}
h2.section-title {
  margin-top: 0;
}
.card {
  background: var(--card-bg);
  border: 1px solid var(--border);
  padding: 12px;
  border-radius: 6px;
  margin: 12px 0;
}
.cmd-wrap {
  position: relative;
}
.copy-btn {
  position: absolute;
  top: 6px;
  right: 6px;
  padding: 4px 10px;
  background: var(--accent);
  border: none;
  border-radius: 5px;
  color: white;
  cursor: pointer;
}

/* =============================
   WORKFLOW DIAGRAM
   ============================= */
.workflow-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
  margin: 20px 0;
}
.workflow-card {
  padding: 12px 18px;
  border-radius: 8px;
  border: 1px solid var(--border);
  background: var(--card-bg);
  text-align: center;
}
.workflow-arrow {
  font-size: 26px;
  color: var(--accent);
}
</style>
</head>

<body>

<!-- =============================
     TOP HEADER (H2 STYLE)
============================== -->
<header>
  <div class="left-group">
    <img src="https://img.icons8.com/color/48/000000/coronavirus.png" width="32" />
    <h2>SARS-CoV-2 Variant Calling Tutorial</h2>
  </div>
  <div class="right-group">
    <input id="searchBox" placeholder="Search tutorial..." />
    <button class="theme-toggle" id="themeToggle">üåô</button>
  </div>
</header>

<div class="container">

<!-- =============================
     COLLAPSIBLE SIDEBAR (SB-1)
============================== -->
<nav>
  <h3 data-target="intro-menu">Introduction</h3>
  <ul id="intro-menu"><li><a href="#intro">Overview</a></li></ul>

  <h3 data-target="wf-menu">Workflow Diagram</h3>
  <ul id="wf-menu"><li><a href="#workflow">Pipeline Overview</a></li></ul>

  <h3 data-target="step1-menu">Step 1 ‚Äî Data Preparation</h3>
  <ul id="step1-menu">
    <li><a href="#step1-download">Download</a></li>
    <li><a href="#step1-fq">FASTQ Conversion</a></li>
    <li><a href="#step1-gzip">Compression</a></li>
  </ul>

  <h3 data-target="step2-menu">Step 2 ‚Äî FastQC</h3>
  <ul id="step2-menu"><li><a href="#step2">Run FastQC</a></li></ul>

  <h3 data-target="step3-menu">Step 3 ‚Äî Trimming</h3>
  <ul id="step3-menu"><li><a href="#step3">Trim Reads</a></li></ul>

  <h3 data-target="step4-menu">Step 4 ‚Äî Alignment</h3>
  <ul id="step4-menu">
    <li><a href="#step4-index">Index Reference</a></li>
    <li><a href="#step4-mem">bwa mem</a></li>
  </ul>

  <h3 data-target="step5-menu">Step 5 ‚Äî BAM Processing</h3>
  <ul id="step5-menu">
    <li><a href="#step5-sam">SAM‚ÜíBAM</a></li>
    <li><a href="#step5-sort">Sorting</a></li>
    <li><a href="#step5-index">Indexing</a></li>
  </ul>

  <h3 data-target="step6-menu">Step 6 ‚Äî Variant Calling</h3>
  <ul id="step6-menu">
    <li><a href="#step6-mpileup">mpileup</a></li>
    <li><a href="#step6-call">Call Variants</a></li>
  </ul>

  <h3 data-target="step7-menu">Step 7 ‚Äî Annotation</h3>
  <ul id="step7-menu">
    <li><a href="#step7-build">Build DB</a></li>
    <li><a href="#step7-ann">Annotate VCF</a></li>
  </ul>

  <h3 data-target="ref-menu">Documentation</h3>
  <ul id="ref-menu">
    <li><a href="#references">Tool Docs</a></li>
  </ul>
</nav>

<!-- =============================
     MAIN CONTENT
============================== -->
<main>
<section id="intro">
  <h2 class="section-title">Introduction</h2>
  <p>This tutorial explains a complete SARS-CoV-2 variant calling workflow using FastQC, Trim Galore, BWA, SAMtools, BCFtools, and SnpEff.</p>
</section>

<section id="workflow">
  <h2 class="section-title">Workflow Diagram</h2>
  <div class="workflow-row">
    <div class="workflow-card">üì•<br>Download</div>
    <div class="workflow-arrow">‚ûú</div>
    <div class="workflow-card">üîç<br>FastQC</div>
    <div class="workflow-arrow">‚ûú</div>
    <div class="workflow-card">‚úÇÔ∏è<br>Trim</div>
    <div class="workflow-arrow">‚ûú</div>
    <div class="workflow-card">üß¨<br>BWA</div>
    <div class="workflow-arrow">‚ûú</div>
    <div class="workflow-card">üßπ<br>SAMtools</div>
    <div class="workflow-arrow">‚ûú</div>
    <div class="workflow-card">üß™<br>BCFtools</div>
    <div class="workflow-arrow">‚ûú</div>
    <div class="workflow-card">üß†<br>SnpEff</div>
  </div>
</section>

<section id="objective">
  <h2 class="section-title">Objective</h2>
  <p>Perform quality control, trimming, reference alignment, variant calling, and annotation for SARS-CoV-2.</p>
</section>

<!-- =============================
     STEP 1
============================== -->
<section id="step1">
  <h2 class="section-title">Step 1 ‚Äî Data Preparation</h2>

  <h3 id="step1-download">Download</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c1">Copy</button>
  <pre id="c1"><code class="language-bash">prefetch SRR15571424</code></pre></div>

  <h3 id="step1-fq">Convert to FASTQ</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c2">Copy</button>
  <pre id="c2"><code class="language-bash">fasterq-dump SRR15571424 -S -e 2</code></pre></div>

  <h3 id="step1-gzip">Compress FASTQ</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c3">Copy</button>
  <pre id="c3"><code class="language-bash">gzip SRR15571424_1.fastq
gzip SRR15571424_2.fastq</code></pre></div>
</section>

<!-- =============================
     STEP 2
============================== -->
<section id="step2">
  <h2 class="section-title">Step 2 ‚Äî Quality Check (FastQC)</h2>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c4">Copy</button>
  <pre id="c4"><code class="language-bash">fastqc *.fastq.gz --threads 4</code></pre></div>
</section>

<!-- =============================
     STEP 3
============================== -->
<section id="step3">
  <h2 class="section-title">Step 3 ‚Äî Read Trimming</h2>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c5">Copy</button>
  <pre id="c5"><code class="language-bash">trim_galore --paired *.fastq.gz</code></pre></div>
</section>

<!-- =============================
     STEP 4
============================== -->
<section id="step4">
  <h2 class="section-title">Step 4 ‚Äî Alignment (BWA)</h2>

  <h3 id="step4-index">Create Index</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c6">Copy</button>
  <pre id="c6"><code class="language-bash">bwa index MN908947.3.fna</code></pre></div>

  <h3 id="step4-mem">Run bwa mem</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c7">Copy</button>
  <pre id="c7"><code class="language-bash">bwa mem MN908947.3.fna reads_1.fq.gz reads_2.fq.gz > aln.sam</code></pre></div>
</section>

<!-- =============================
     STEP 5
============================== -->
<section id="step5">
  <h2 class="section-title">Step 5 ‚Äî BAM Processing (SAMtools)</h2>

  <h3 id="step5-sam">SAM ‚Üí BAM</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c8">Copy</button>
  <pre id="c8"><code class="language-bash">samtools view -bS aln.sam > aln.bam</code></pre></div>

  <h3 id="step5-sort">Sorting</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c9">Copy</button>
  <pre id="c9"><code class="language-bash">samtools sort aln.bam -o aln.sorted.bam</code></pre></div>

  <h3 id="step5-index">Indexing</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c10">Copy</button>
  <pre id="c10"><code class="language-bash">samtools index aln.sorted.bam</code></pre></div>
</section>

<!-- =============================
     STEP 6
============================== -->
<section id="step6">
  <h2 class="section-title">Step 6 ‚Äî Variant Calling (BCFtools)</h2>

  <h3 id="step6-mpileup">mpileup</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c11">Copy</button>
  <pre id="c11"><code class="language-bash">bcftools mpileup -f MN908947.3.fna aln.sorted.bam -Ou > raw.bcf</code></pre></div>

  <h3 id="step6-call">Call Variants</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c12">Copy</button>
  <pre id="c12"><code class="language-bash">bcftools call -mv -Ov --ploidy 1 raw.bcf > variants.vcf</code></pre></div>
</section>

<!-- =============================
     STEP 7
============================== -->
<section id="step7">
  <h2 class="section-title">Step 7 ‚Äî Annotation (SnpEff)</h2>

  <h3 id="step7-build">Build Database</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c13">Copy</button>
  <pre id="c13"><code class="language-bash">/snpEff/scripts/buildDbNcbi.sh MN908947.3</code></pre></div>

  <h3 id="step7-ann">Annotate VCF</h3>
  <div class="cmd-wrap"><button class="copy-btn" data-target="c14">Copy</button>
  <pre id="c14"><code class="language-bash">java -jar snpEff.jar ann MN908947.3 variants.vcf > annotated.vcf</code></pre></div>

</section>

<!-- =============================
     REFERENCES
============================== -->
<section id="references">
  <h2 class="section-title">Tool Documentation & References</h2>
  <ul>
    <li><a href="https://github.com/ncbi/sra-tools" target="_blank">SRA Toolkit</a></li>
    <li><a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/" target="_blank">FastQC</a></li>
    <li><a href="https://www.bioinformatics.babraham.ac.uk/projects/trim_galore/" target="_blank">Trim Galore</a></li>
    <li><a href="https://github.com/lh3/bwa" target="_blank">BWA</a></li>
    <li><a href="https://www.htslib.org/" target="_blank">SAMtools</a></li>
    <li><a href="https://samtools.github.io/bcftools/" target="_blank">BCFtools</a></li>
    <li><a href="https://pcingola.github.io/SnpEff/" target="_blank">SnpEff</a></li>
  </ul>
</section>

<!-- =============================
     END SECTION + FOOTER PLACEHOLDER
============================== -->
<section id="end">
  <h2 class="section-title">End of Tutorial</h2>
  <p>You have completed the SARS-CoV-2 Variant Calling Tutorial.</p>
</section>

<footer>
  <p>Created for ICE-Cloud users.</p>
</footer>

<!-- JS placeholders for next step (theme toggle, copy, sidebar, search) -->
<script>
// ==== PREMIUM JAVASCRIPT LAYER (Dark/Light, Sidebar, ScrollSpy, Search SR-1, Copy Buttons) ====

// Search Mode: SR-1 (minimal highlight)
// Functions will be injected in next update.
</script>



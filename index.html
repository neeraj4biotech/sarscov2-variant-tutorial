<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>SARS-CoV-2 Variant Calling Tutorial ‚Äî ICE-Cloud</title>

<!-- =======================
     BASIC PAGE STYLING
======================= -->
<style>
body {font-family: Arial, sans-serif; margin: 0; padding: 0; line-height:1.6;}
#sidebar {width: 260px; background:#f4f4f4; height:100vh; position:fixed; overflow:auto; padding:20px; border-right:1px solid #ccc;}
#content {margin-left:280px; padding:30px;}
h2 {color:#0b63a5; margin-top:48px;}
h3 {color:#0b63a5; margin-top:32px;}
.box {background:#e8f2ff; border-left:4px solid #0b63a5; padding:10px 14px; margin:12px 0; white-space:pre-line;}
pre {background:#111827; color:#e5e7eb; padding:12px; border-radius:6px; overflow:auto;}
.copy-btn {background:#0b63a5; color:white; border:none; padding:6px 10px; margin-bottom:6px; cursor:pointer; border-radius:4px;}
.workflow {text-align:center; margin:20px 0; font-size:32px;}
a {text-decoration:none; color:#0b63a5;}
a:hover {text-decoration:underline;}
.active {font-weight:bold; text-decoration:underline;}

/* Smooth Scroll */
html { scroll-behavior: smooth; }
</style>

</head>
<body>

<!-- =======================
     SIDEBAR NAVIGATION
======================= -->
<div id="sidebar">
<h3>Contents</h3>
<ul>
<li><a href="#intro">Introduction</a></li>
<li><a href="#objective">Objective</a></li>
<li><a href="#step1">Step 1 ‚Äî Data Preparation</a></li>
<li><a href="#step2">Step 2 ‚Äî FastQC</a></li>
<li><a href="#step3">Step 3 ‚Äî Trimming</a></li>
<li><a href="#step4">Step 4 ‚Äî Alignment</a></li>
<li><a href="#step5">Step 5 ‚Äî BAM Processing</a></li>
<li><a href="#step6">Step 6 ‚Äî Variant Calling</a></li>
<li><a href="#step7">Step 7 ‚Äî Annotation</a></li>
<li><a href="#docs">Tool Documentation</a></li>
<li><a href="#end">End of Tutorial</a></li>
</ul>
</div>

<!-- =======================
     MAIN CONTENT
======================= -->
<div id="content">

<!-- INTRODUCTION -->
<h2 id="intro">Introduction</h2>
<p>
Next-generation sequencing (NGS) technology has transformed research in disease surveillance 
and diagnostics. A major application has been tracking emerging mutations in the SARS-CoV-2 genome,
which helps monitor viral evolution, transmissibility, vaccine effectiveness, and informs public health decisions.
ICE-Cloud, developed by C-DAC Pune, provides a unified platform for data storage, analysis, and sharing.
This tutorial demonstrates the execution of a SARS-CoV-2 variant calling pipeline on ICE-Cloud.
</p>

<!-- WORKFLOW SECTION -->
<h2>Workflow Diagram</h2>
<div class="workflow">
üì• ‚ûú üîç ‚ûú ‚úÇÔ∏è ‚ûú üß¨ ‚ûú üßπ ‚ûú üß™ ‚ûú üß†
</div>

<!-- OBJECTIVE -->
<h2 id="objective">Objective</h2>
<p>
To perform reference-based mapping and variant calling of NGS data using ICE-Cloud, including:
<strong>uploading data, QC, trimming, alignment, variant calling, annotation, and interpretation.</strong>
</p>

<!-- STEP 1 -->
<h2 id="step1">Step 1 ‚Äî Data Preparation</h2>

<div class="box">
Instructions to start ICE Job Container:
Home ‚Üí Images ‚Üí Image Library ‚Üí Search ‚Äúsratoolkit‚Äù
Memory: 8 GB  
CPU: 2  
Connect to terminal after container starts.
</div>

<button class="copy-btn" onclick="copyText('cmd1')">Copy</button>
<pre id="cmd1">prefetch SRR15571424
fasterq-dump SRR15571424 -S -e 2
gzip fastq/SRR15571424_1.fastq
gzip fastq/SRR15571424_2.fastq</pre>

<!-- STEP 2 -->
<h2 id="step2">Step 2 ‚Äî Quality Check (FastQC)</h2>

<div class="box">
Start container: fastqc  
Memory: 8 GB  
CPU: 2
</div>

<button class="copy-btn" onclick="copyText('cmd2')">Copy</button>
<pre id="cmd2">cp -r /drive/public/ICE_Workshop/AIC_CCMB/var_call_tutorial .
cd var_call_tutorial
fastqc --threads 5 SRR15571424_1.fastq.gz SRR15571424_2.fastq.gz
ls -lrth</pre>

<!-- STEP 3 -->
<h2 id="step3">Step 3 ‚Äî Read Trimming (Trim Galore)</h2>

<div class="box">
Start container: trim_galore  
Memory: 8 GB  
CPU: 2
</div>

<button class="copy-btn" onclick="copyText('cmd3')">Copy</button>
<pre id="cmd3">cd var_call_tutorial
trim_galore --fastqc --paired SRR15571424_1.fastq.gz SRR15571424_2.fastq.gz
ls -lrth</pre>

<!-- STEP 4 -->
<h2 id="step4">Step 4 ‚Äî Reference Alignment (BWA)</h2>

<div class="box">
Start container: bwa  
Memory: 8 GB  
CPU: 2
</div>

<button class="copy-btn" onclick="copyText('cmd4')">Copy</button>
<pre id="cmd4">cd var_call_tutorial
bwa index MN908947.3.fna
bwa mem -t 2 -R "@RG	ID:SRR15571424	SM:SRR15571424	PL:illumina	LB:lib1	PU:unit1" -V -M -o SRR15571424.sam MN908947.3.fna SRR15571424_1_val_1.fq.gz SRR15571424_2_val_2.fq.gz
ls -lrth</pre>
<!-- ======================================
     STEP 5 ‚Äî BAM PROCESSING
======================================= -->
<h2 id="step5">Step 5 ‚Äî BAM Processing (SAMtools)</h2>

<div class="box">
Start container: samtools  
Memory: 8 GB  
CPU: 2
</div>

<button class="copy-btn" onclick="copyText('cmd5')">Copy</button>
<pre id="cmd5">samtools view -S -b SRR15571424.sam -o SRR15571424.bam --threads 5
samtools sort SRR15571424.bam -o SRR15571424_sorted.bam --threads 5
samtools index SRR15571424_sorted.bam
samtools view -b -F 4 SRR15571424_sorted.bam > SRR15571424_mapped.bam
samtools view -b -f 4 SRR15571424_sorted.bam > SRR15571424_unmapped.bam
samtools flagstat SRR15571424_sorted.bam
ls -lrth</pre>

<!-- ======================================
     STEP 6 ‚Äî VARIANT CALLING
======================================= -->
<h2 id="step6">Step 6 ‚Äî Variant Calling (BCFtools)</h2>

<div class="box">
Start container: bcftools  
Memory: 8 GB  
CPU: 2
</div>

<button class="copy-btn" onclick="copyText('cmd6')">Copy</button>
<pre id="cmd6">bcftools mpileup -f MN908947.3.fna -Ou --threads 5 SRR15571424_sorted.bam -o SRR15571424.bcf
bcftools call -mv -Ov --ploidy 1 --threads 2 SRR15571424.bcf -o SRR15571424.vcf
ls -lrth</pre>

<!-- ======================================
     STEP 7 ‚Äî VARIANT ANNOTATION
======================================= -->
<h2 id="step7">Step 7 ‚Äî Variant Annotation (SnpEff)</h2>

<div class="box">
Start container: snpeff  
Memory: 8 GB  
CPU: 2
</div>

<button class="copy-btn" onclick="copyText('cmd7')">Copy</button>
<pre id="cmd7">/snpEff/scripts/buildDbNcbi.sh MN908947.3
java -jar /snpEff/snpEff.jar ann -v MN908947.3 SRR15571424.vcf \
  -csvStats SRR15571424_stat.csv \
  -htmlStats SRR15571424_stat.html > SRR15571424_ann.vcf

grep "missense_variant" SRR15571424_ann.vcf
grep "MODERATE" SRR15571424_ann.vcf
grep "LOW" SRR15571424_ann.vcf
</pre>

<!-- ======================================
     TOOL DOCUMENTATION
======================================= -->
<h2 id="docs">Tool Documentation</h2>

<ul>
<li><a href="https://github.com/ncbi/sra-tools" target="_blank">SRA Toolkit</a></li>
<li><a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/" target="_blank">FastQC</a></li>
<li><a href="https://www.bioinformatics.babraham.ac.uk/projects/trim_galore/" target="_blank">Trim Galore</a></li>
<li><a href="https://github.com/lh3/bwa" target="_blank">BWA</a></li>
<li><a href="https://www.htslib.org/" target="_blank">SAMtools</a></li>
<li><a href="https://samtools.github.io/bcftools/bcftools.html" target="_blank">BCFtools</a></li>
<li><a href="https://pcingola.github.io/SnpEff/" target="_blank">SnpEff</a></li>
</ul>

<!-- ======================================
     END OF TUTORIAL
======================================= -->
<h2 id="end">End of Tutorial</h2>
<p>You have completed the SARS-CoV-2 Variant Calling Tutorial on ICE-Cloud.</p>
<p>Created for ICE-Cloud users ‚Äî includes copy buttons and tool documentation links.</p>

</div> <!-- END CONTENT -->

<!-- ======================================
     JAVASCRIPT ‚Äî COPY BUTTON + SCROLL HIGHLIGHT
======================================= -->
<script>
// COPY BUTTON FUNCTIONALITY
function copyText(id) {
    const text = document.getElementById(id).innerText;
    navigator.clipboard.writeText(text);
    alert("Copied to clipboard!");
}

// SCROLL SPY TO HIGHLIGHT ACTIVE SIDEBAR LINK
document.addEventListener("scroll", () => {
    const sections = document.querySelectorAll("h2[id]");
    let scrollPos = window.scrollY + 120;

    sections.forEach(sec => {
        const top = sec.offsetTop;
        const bottom = top + sec.offsetHeight;
        const id = sec.getAttribute("id");

        const link = document.querySelector(`#sidebar a[href="#${id}"]`);
        if (!link) return;

        if (scrollPos >= top && scrollPos < bottom) {
            link.classList.add("active");
        } else {
            link.classList.remove("active");
        }
    });
});
</script>

</body>
</html>


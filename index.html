<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SARS-CoV-2 Variant Calling Tutorial ‚Äî ICE-Cloud</title>

<style>
body {
  margin: 0;
  font-family: Arial, Helvetica, sans-serif;
  line-height: 1.7;
  background: #ffffff;
  color: #111;
}

#sidebar {
  position: fixed;
  top: 0;
  left: 0;
  width: 270px;
  height: 100vh;
  overflow-y: auto;
  background: #f5f7fa;
  border-right: 1px solid #ddd;
  padding: 20px;
}

#content {
  margin-left: 290px;
  padding: 30px;
  max-width: 1100px;
}

h1, h2 {
  color: #0b63a5;
}

a.tool-link {
  color: #0b63a5;
  font-weight: 600;
  text-decoration: none;
}

a.tool-link:hover {
  text-decoration: underline;
}

.note {
  background: #eef5ff;
  border-left: 4px solid #0b63a5;
  padding: 12px 16px;
  margin: 15px 0;
}

pre {
  background: #0f172a;
  color: #e5e7eb;
  padding: 14px;
  border-radius: 6px;
  overflow-x: auto;
}

.copy-btn {
  background: #0b63a5;
  color: white;
  border: none;
  padding: 6px 12px;
  border-radius: 5px;
  cursor: pointer;
  margin-bottom: 6px;
}

details {
  background: #fafafa;
  border: 1px solid #ddd;
  border-radius: 6px;
  padding: 12px;
  margin-top: 25px;
}

summary {
  font-size: 18px;
  font-weight: bold;
  cursor: pointer;
  color: #0b63a5;
}

.workflow {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 12px;
  margin: 20px 0;
}

.wf-box {
  background: #e8f1fb;
  border: 1px solid #0b63a5;
  padding: 10px 14px;
  border-radius: 6px;
  text-align: center;
  min-width: 120px;
}

.arrow {
  font-size: 22px;
}
</style>

<script>
function copyText(id) {
  navigator.clipboard.writeText(document.getElementById(id).innerText);
}
</script>
</head>

<body>

<div id="sidebar">
<h2>Contents</h2>
<ul>
  <li><a href="#intro">Introduction</a></li>
  <li><a href="#workflow">Workflow Diagram</a></li>
  <li><a href="#objective">Objective</a></li>
  <li><a href="#step1">Step 1 ‚Äî Data Preparation</a></li>
  <li><a href="#step2">Step 2 ‚Äî Quality Check</a></li>
  <li><a href="#step3">Step 3 ‚Äî Read Trimming</a></li>
  <li><a href="#step4">Step 4 ‚Äî Alignment</a></li>
  <li><a href="#step5">Step 5 ‚Äî BAM Processing</a></li>
  <li><a href="#step6">Step 6 ‚Äî Variant Calling</a></li>
  <li><a href="#step7">Step 7 ‚Äî Annotation</a></li>
  <li><a href="#docs">Tool Documentation</a></li>
</ul>
</div>

<div id="content">

<h1 id="intro">SARS-CoV-2 Variant Calling Pipeline on 
<a class="tool-link" href="https://icecloud.in/home" target="_blank">ICE-Cloud</a>
</h1>

<p>
Next-generation sequencing (NGS) technology has transformed research in disease surveillance
and diagnostics. A major application has been tracking emerging mutations in the
SARS-CoV-2 genome, which helps monitor viral evolution, transmissibility, vaccine effectiveness,
and informs public health decisions.
</p>

<p>
The combination of reference genomes, genome-specific primers, and standardized bioinformatics
workflows enabled rapid, high-throughput genomic analysis during the COVID-19 pandemic.
However, limited access to bioinformatics infrastructure and challenges in authorized data
sharing remain common hurdles.
</p>

<p>
<a class="tool-link" href="https://icecloud.in/home" target="_blank">ICE-Cloud</a>,
developed by the HPC-Medical and Bioinformatics group at <strong>C-DAC Pune</strong>,
addresses these challenges by providing a unified platform for data storage, analysis,
and sharing. This tutorial demonstrates a complete SARS-CoV-2 variant calling workflow
executed on <a class="tool-link" href="https://icecloud.in/home" target="_blank">ICE-Cloud</a>.
</p>

<h2 id="workflow">Workflow Diagram</h2>

<div class="workflow">
  <div class="wf-box">üì•<br>Download<br>SRA</div>
  <div class="arrow">‚ûú</div>
  <div class="wf-box">üîç<br>
    <a class="tool-link" href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/" target="_blank">FastQC</a>
  </div>
  <div class="arrow">‚ûú</div>
  <div class="wf-box">‚úÇÔ∏è<br>
    <a class="tool-link" href="https://www.bioinformatics.babraham.ac.uk/projects/trim_galore/" target="_blank">Trim Galore</a>
  </div>
  <div class="arrow">‚ûú</div>
  <div class="wf-box">üß¨<br>
    <a class="tool-link" href="https://github.com/lh3/bwa" target="_blank">BWA</a>
  </div>
  <div class="arrow">‚ûú</div>
  <div class="wf-box">üßπ<br>
    <a class="tool-link" href="https://www.htslib.org/" target="_blank">SAMtools</a>
  </div>
  <div class="arrow">‚ûú</div>
  <div class="wf-box">üß™<br>
    <a class="tool-link" href="https://samtools.github.io/bcftools/" target="_blank">BCFtools</a>
  </div>
  <div class="arrow">‚ûú</div>
  <div class="wf-box">üß†<br>
    <a class="tool-link" href="https://pcingola.github.io/SnpEff/" target="_blank">SnpEff</a>
  </div>
</div>

<h2 id="objective">Objective</h2>

<p>
To perform reference-based mapping and variant calling of NGS data using
<a class="tool-link" href="https://icecloud.in/home" target="_blank">ICE-Cloud</a>,
a high-performance computing platform designed for bioinformatics workflows.
This tutorial guides users through uploading data, quality assessment, read trimming,
reference-based alignment, variant calling with annotation, and result interpretation.
</p>
<!-- ================= STEP 1 ================= -->
<details id="step1">
<summary>
Step 1 ‚Äî Data Preparation (
<a class="tool-link" href="https://github.com/ncbi/sra-tools" target="_blank">SRA Toolkit</a>
)
</summary>

<p><strong>What this step does:</strong><br>
Downloads raw sequencing data from the NCBI Sequence Read Archive (SRA) and converts it into
FASTQ format, which is required for downstream quality control and alignment.
</p>

<div class="note">
<strong>ICE-Cloud container setup:</strong><br>
Platform: <a class="tool-link" href="https://icecloud.in/home" target="_blank">ICE-Cloud</a><br>
Image: <a class="tool-link" href="https://github.com/ncbi/sra-tools" target="_blank">SRA Toolkit</a><br>
CPU: 2 &nbsp; | &nbsp; Memory: 8 GB
</div>

<button class="copy-btn" onclick="copyText('cmd1')">Copy</button>
<pre id="cmd1">prefetch SRR15571424
fasterq-dump SRR15571424 -S -e 2
gzip fastq/SRR15571424_1.fastq
gzip fastq/SRR15571424_2.fastq</pre>

<p><strong>Explanation of parameters:</strong></p>
<ul>
<li><code>prefetch</code> ‚Äî downloads the SRA file from NCBI.</li>
<li><code>fasterq-dump</code> ‚Äî converts SRA format into FASTQ.</li>
<li><code>-S</code> ‚Äî splits paired-end reads into separate files.</li>
<li><code>-e 2</code> ‚Äî uses two CPU threads.</li>
<li><code>gzip</code> ‚Äî compresses FASTQ files to reduce disk usage.</li>
</ul>
</details>

<!-- ================= STEP 2 ================= -->
<details id="step2">
<summary>
Step 2 ‚Äî Quality Check (
<a class="tool-link" href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/" target="_blank">FastQC</a>
)
</summary>

<p><strong>What this step does:</strong><br>
Evaluates the quality of raw sequencing reads, including base quality scores, GC content,
sequence duplication levels, and adapter contamination.
</p>

<div class="note">
<strong>ICE-Cloud container setup:</strong><br>
Platform: <a class="tool-link" href="https://icecloud.in/home" target="_blank">ICE-Cloud</a><br>
Image: <a class="tool-link" href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/" target="_blank">FastQC</a><br>
CPU: 2 &nbsp; | &nbsp; Memory: 8 GB
</div>

<button class="copy-btn" onclick="copyText('cmd2')">Copy</button>
<pre id="cmd2">cp -r /drive/public/ICE_Workshop/AIC_CCMB/var_call_tutorial .
cd var_call_tutorial
fastqc --threads 5 SRR15571424_1.fastq.gz SRR15571424_2.fastq.gz
ls -lrth</pre>

<p><strong>Explanation of parameters:</strong></p>
<ul>
<li><code>--threads 5</code> ‚Äî runs FastQC using five CPU cores.</li>
<li><code>SRR15571424_1.fastq.gz</code> ‚Äî forward reads.</li>
<li><code>SRR15571424_2.fastq.gz</code> ‚Äî reverse reads.</li>
<li><code>ls -lrth</code> ‚Äî lists generated FastQC reports.</li>
</ul>
</details>

<!-- ================= STEP 3 ================= -->
<details id="step3">
<summary>
Step 3 ‚Äî Read Trimming (
<a class="tool-link" href="https://www.bioinformatics.babraham.ac.uk/projects/trim_galore/" target="_blank">Trim Galore</a>
)
</summary>

<p><strong>What this step does:</strong><br>
Removes sequencing adapters and low-quality bases from reads to improve alignment accuracy
and reduce false-positive variant calls.
</p>

<div class="note">
<strong>ICE-Cloud container setup:</strong><br>
Platform: <a class="tool-link" href="https://icecloud.in/home" target="_blank">ICE-Cloud</a><br>
Image: <a class="tool-link" href="https://www.bioinformatics.babraham.ac.uk/projects/trim_galore/" target="_blank">Trim Galore</a><br>
CPU: 2 &nbsp; | &nbsp; Memory: 8 GB
</div>

<button class="copy-btn" onclick="copyText('cmd3')">Copy</button>
<pre id="cmd3">cd var_call_tutorial
trim_galore --fastqc --paired SRR15571424_1.fastq.gz SRR15571424_2.fastq.gz
ls -lrth</pre>

<p><strong>Explanation of parameters:</strong></p>
<ul>
<li><code>--paired</code> ‚Äî specifies paired-end reads.</li>
<li><code>--fastqc</code> ‚Äî performs FastQC on trimmed reads.</li>
<li><code>_val_1.fq.gz</code> / <code>_val_2.fq.gz</code> ‚Äî trimmed output files.</li>
</ul>
</details>

<!-- ================= STEP 4 ================= -->
<details id="step4">
<summary>
Step 4 ‚Äî Reference Alignment (
<a class="tool-link" href="https://github.com/lh3/bwa" target="_blank">BWA</a>
)
</summary>

<p><strong>What this step does:</strong><br>
Aligns trimmed sequencing reads to the SARS-CoV-2 reference genome to determine their
genomic positions and generate alignment files.
</p>

<div class="note">
<strong>ICE-Cloud container setup:</strong><br>
Platform: <a class="tool-link" href="https://icecloud.in/home" target="_blank">ICE-Cloud</a><br>
Image: <a class="tool-link" href="https://github.com/lh3/bwa" target="_blank">BWA</a><br>
CPU: 2 &nbsp; | &nbsp; Memory: 8 GB
</div>

<button class="copy-btn" onclick="copyText('cmd4')">Copy</button>
<pre id="cmd4">cd var_call_tutorial
bwa index MN908947.3.fna

bwa mem -t 2 \
-R "@RG\tID:SRR15571424\tSM:SRR15571424\tPL:illumina\tLB:lib1\tPU:unit1" \
-V -M \
-o SRR15571424.sam \
MN908947.3.fna \
SRR15571424_1_val_1.fq.gz SRR15571424_2_val_2.fq.gz

ls -lrth</pre>

<p><strong>Explanation of parameters:</strong></p>
<ul>
<li><code>bwa index</code> ‚Äî builds index for the reference genome.</li>
<li><code>-t 2</code> ‚Äî uses two CPU threads.</li>
<li><code>-R</code> ‚Äî adds Read Group metadata required for variant calling.</li>
<li><code>-M</code> ‚Äî marks split reads as secondary.</li>
<li><code>-o</code> ‚Äî specifies output SAM file.</li>
</ul>
</details>
<!-- ================= STEP 5 ================= -->
<details id="step5">
<summary>
Step 5 ‚Äî BAM Processing (
<a class="tool-link" href="https://www.htslib.org/" target="_blank">SAMtools</a>
)
</summary>

<p><strong>What this step does:</strong><br>
Processes alignment files by converting SAM to BAM format, sorting reads by genomic
coordinates, indexing alignments, and generating mapping statistics.
</p>

<div class="note">
<strong>ICE-Cloud container setup:</strong><br>
Platform: <a class="tool-link" href="https://icecloud.in/home" target="_blank">ICE-Cloud</a><br>
Image: <a class="tool-link" href="https://www.htslib.org/" target="_blank">SAMtools</a><br>
CPU: 2 &nbsp; | &nbsp; Memory: 8 GB
</div>

<button class="copy-btn" onclick="copyText('cmd5')">Copy</button>
<pre id="cmd5">samtools view -S -b SRR15571424.sam -o SRR15571424.bam --threads 5
samtools sort SRR15571424.bam -o SRR15571424_sorted.bam --threads 5
samtools index SRR15571424_sorted.bam

samtools view -b -F 4 SRR15571424_sorted.bam > SRR15571424_mapped.bam
samtools view -b -f 4 SRR15571424_sorted.bam > SRR15571424_unmapped.bam

samtools flagstat SRR15571424_sorted.bam
ls -lrth</pre>

<p><strong>Explanation of parameters:</strong></p>
<ul>
<li><code>view -S -b</code> ‚Äî converts SAM to BAM format.</li>
<li><code>sort</code> ‚Äî sorts alignments by genomic coordinates.</li>
<li><code>index</code> ‚Äî creates BAM index file (<code>.bai</code>).</li>
<li><code>-F 4</code> ‚Äî selects mapped reads.</li>
<li><code>-f 4</code> ‚Äî selects unmapped reads.</li>
<li><code>flagstat</code> ‚Äî reports alignment statistics.</li>
</ul>
</details>

<!-- ================= STEP 6 ================= -->
<details id="step6">
<summary>
Step 6 ‚Äî Variant Calling (
<a class="tool-link" href="https://samtools.github.io/bcftools/" target="_blank">BCFtools</a>
)
</summary>

<p><strong>What this step does:</strong><br>
Identifies single nucleotide variants (SNVs) and small insertions/deletions
from aligned reads and generates a Variant Call Format (VCF) file.
</p>

<div class="note">
<strong>ICE-Cloud container setup:</strong><br>
Platform: <a class="tool-link" href="https://icecloud.in/home" target="_blank">ICE-Cloud</a><br>
Image: <a class="tool-link" href="https://samtools.github.io/bcftools/" target="_blank">BCFtools</a><br>
CPU: 2 &nbsp; | &nbsp; Memory: 8 GB
</div>

<button class="copy-btn" onclick="copyText('cmd6')">Copy</button>
<pre id="cmd6">bcftools mpileup -f MN908947.3.fna -Ou --threads 5 SRR15571424_sorted.bam -o SRR15571424.bcf
bcftools call -mv -Ov --ploidy 1 --threads 2 SRR15571424.bcf -o SRR15571424.vcf
ls -lrth</pre>

<p><strong>Explanation of parameters:</strong></p>
<ul>
<li><code>mpileup</code> ‚Äî summarizes base information at each genomic position.</li>
<li><code>-f</code> ‚Äî reference genome FASTA file.</li>
<li><code>-Ou</code> ‚Äî uncompressed BCF output.</li>
<li><code>call -mv</code> ‚Äî calls SNPs and indels.</li>
<li><code>--ploidy 1</code> ‚Äî SARS-CoV-2 genome is haploid.</li>
</ul>
</details>

<!-- ================= STEP 7 ================= -->
<details id="step7">
<summary>
Step 7 ‚Äî Variant Annotation (
<a class="tool-link" href="https://pcingola.github.io/SnpEff/" target="_blank">SnpEff</a>
)
</summary>

<p><strong>What this step does:</strong><br>
Annotates detected variants to predict their functional impact on genes
and proteins and generates summary statistics.
</p>

<div class="note">
<strong>ICE-Cloud container setup:</strong><br>
Platform: <a class="tool-link" href="https://icecloud.in/home" target="_blank">ICE-Cloud</a><br>
Image: <a class="tool-link" href="https://pcingola.github.io/SnpEff/" target="_blank">SnpEff</a><br>
CPU: 2 &nbsp; | &nbsp; Memory: 8 GB
</div>

<button class="copy-btn" onclick="copyText('cmd7')">Copy</button>
<pre id="cmd7">/snpEff/scripts/buildDbNcbi.sh MN908947.3

java -jar /snpEff/snpEff.jar ann -v MN908947.3 SRR15571424.vcf \
-csvStats SRR15571424_stat.csv \
-htmlStats SRR15571424_stat.html \
> SRR15571424_ann.vcf

cat SRR15571424_ann.vcf | grep "missense_variant"
cat SRR15571424_ann.vcf | grep "MODERATE"
cat SRR15571424_ann.vcf | grep "LOW"</pre>

<p><strong>Explanation of parameters:</strong></p>
<ul>
<li><code>buildDbNcbi.sh</code> ‚Äî builds SnpEff database from NCBI reference files.</li>
<li><code>ann</code> ‚Äî annotates variants in the VCF file.</li>
<li><code>-csvStats</code> ‚Äî generates CSV summary statistics.</li>
<li><code>-htmlStats</code> ‚Äî generates HTML summary report.</li>
<li><code>grep</code> ‚Äî filters variants by predicted impact.</li>
</ul>
</details>

<!-- ================= DOCUMENTATION ================= -->
<h2 id="docs">Tool Documentation & References</h2>

<ul>
<li><a class="tool-link" href="https://github.com/ncbi/sra-tools" target="_blank">SRA Toolkit</a></li>
<li><a class="tool-link" href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/" target="_blank">FastQC</a></li>
<li><a class="tool-link" href="https://www.bioinformatics.babraham.ac.uk/projects/trim_galore/" target="_blank">Trim Galore</a></li>
<li><a class="tool-link" href="https://github.com/lh3/bwa" target="_blank">BWA</a></li>
<li><a class="tool-link" href="https://www.htslib.org/" target="_blank">SAMtools</a></li>
<li><a class="tool-link" href="https://samtools.github.io/bcftools/" target="_blank">BCFtools</a></li>
<li><a class="tool-link" href="https://pcingola.github.io/SnpEff/" target="_blank">SnpEff</a></li>
</ul>

<hr>

<p><strong>End of Tutorial</strong><br>
You have completed a full SARS-CoV-2 reference-based variant calling workflow
on <a class="tool-link" href="https://icecloud.in/home" target="_blank">ICE-Cloud</a>,
from raw sequencing data to annotated variants.
</p>

</div> <!-- content -->

</body>
</html>


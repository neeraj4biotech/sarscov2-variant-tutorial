<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>SARS-CoV-2 Variant Calling Tutorial ‚Äî ICE-Cloud</title>

<!-- Prism.js Syntax Highlighting -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>

<style>
body {
    font-family: Arial, sans-serif; margin: 0; padding: 0; line-height: 1.6;
}

/* SIDEBAR */
#sidebar {
    width: 260px; background: #f4f4f4; height: 100vh;
    position: fixed; overflow:auto; padding:20px; border-right:1px solid #ccc;
}
#sidebar a { text-decoration:none; color:#0b63a5; }
#sidebar a:hover { text-decoration:underline; }

/* MAIN PANEL */
#content {
    margin-left: 280px; padding: 30px;
}

/* HEADINGS */
h2 { color:#0b63a5; margin-top:40px; }

/* INFO BOX */
.box {
    background:#e8f2ff; border-left:4px solid #0b63a5;
    padding:12px 14px; margin:12px 0; white-space:pre-line;
}

/* CODE BLOCKS */
pre {
    border-radius:6px;
}

/* COPY BUTTON */
.copy-btn {
    background:#0b63a5; color:white; border:none;
    padding:6px 10px; cursor:pointer; border-radius:4px;
}

/* WORKFLOW */
.workflow {
    text-align:center; margin:20px 0; font-size:40px;
}

/* COLLAPSIBLE STEP BLOCKS */
.step-block {
    background:#0b63a5; color:white;
    padding:12px 16px; border-radius:6px;
    cursor:pointer; margin-top:25px; font-size:18px;
}
.step-content {
    display:none; margin-top:10px;
}
</style>
</head>

<body>

<!-- SIDEBAR -->
<div id="sidebar">
<h3>Contents</h3>
<ul>
<li><a href="#intro" onclick="openStepFromSidebar('intro')">Introduction</a></li>
<li><a href="#objective" onclick="openStepFromSidebar('objective')">Objective</a></li>
<li><a href="#workflow" onclick="openStepFromSidebar('workflow')">Workflow Diagram</a></li>

<li><a href="#step1" onclick="openStepFromSidebar('step1')">Step 1 ‚Äî Data Preparation</a></li>
<li><a href="#step2" onclick="openStepFromSidebar('step2')">Step 2 ‚Äî FastQC</a></li>
<li><a href="#step3" onclick="openStepFromSidebar('step3')">Step 3 ‚Äî Trimming</a></li>
<li><a href="#step4" onclick="openStepFromSidebar('step4')">Step 4 ‚Äî Alignment</a></li>
<li><a href="#step5" onclick="openStepFromSidebar('step5')">Step 5 ‚Äî BAM Processing</a></li>
<li><a href="#step6" onclick="openStepFromSidebar('step6')">Step 6 ‚Äî Variant Calling</a></li>
<li><a href="#step7" onclick="openStepFromSidebar('step7')">Step 7 ‚Äî Annotation</a></li>

<li><a href="#docs" onclick="openStepFromSidebar('docs')">Tool Documentation</a></li>
</ul>
</div>


<!-- MAIN CONTENT -->
<div id="content">

<h2 id="intro">Introduction</h2>
<p>
Next-generation sequencing (NGS) has transformed genomic surveillance for SARS-CoV-2.
ICE-Cloud, developed by C-DAC Pune, provides a unified environment for end-to-end genome analysis.
This tutorial demonstrates a complete SARS-CoV-2 reference-based variant calling workflow.
</p>

<h2 id="workflow">Workflow Diagram</h2>
<div class="workflow">üì• ‚ûú üîç ‚ûú ‚úÇÔ∏è ‚ûú üß¨ ‚ûú üßπ ‚ûú üß™ ‚ûú üß†</div>

<h2 id="objective">Objective</h2>
<p>
Perform reference-based mapping, trimming, QC, alignment, variant calling, and annotation on ICE-Cloud.
</p>

<!-- STEP 1 BLOCK -->
<div class="step-block" id="step1" onclick="toggleStep('step1-content')">
    Step 1 ‚Äî Data Preparation
</div>
<div class="step-content" id="step1-content">
<div class="box">
Start container: <strong>SRA Toolkit</strong>  
Memory: 8 GB  
CPU: 2
</div>

<button class="copy-btn" onclick="copyText('cmd1')">Copy</button>
<pre id="cmd1" class="language-bash"><code>prefetch SRR15571424
fasterq-dump SRR15571424 -S -e 2
gzip fastq/SRR15571424_1.fastq
gzip fastq/SRR15571424_2.fastq</code></pre>
</div>

<!-- STEP 2 BLOCK -->
<div class="step-block" id="step2" onclick="toggleStep('step2-content')">
    Step 2 ‚Äî Quality Check (FastQC)
</div>
<div class="step-content" id="step2-content">
<div class="box">Start container: <strong>FastQC</strong></div>

<button class="copy-btn" onclick="copyText('cmd2')">Copy</button>
<pre id="cmd2" class="language-bash"><code>cp -r /drive/public/ICE_Workshop/AIC_CCMB/var_call_tutorial .
cd var_call_tutorial
fastqc --threads 5 SRR15571424_1.fastq.gz SRR15571424_2.fastq.gz</code></pre>
</div>

<!-- PART 1 ends here -->
<!-- STEP 3 BLOCK -->
<div class="step-block" id="step3" onclick="toggleStep('step3-content')">
    Step 3 ‚Äî Read Trimming (Trim Galore)
</div>
<div class="step-content" id="step3-content">
<div class="box">Start container: <strong>Trim Galore</strong></div>

<button class="copy-btn" onclick="copyText('cmd3')">Copy</button>
<pre id="cmd3" class="language-bash"><code>trim_galore --fastqc --paired SRR15571424_1.fastq.gz SRR15571424_2.fastq.gz</code></pre>
</div>

<!-- STEP 4 BLOCK -->
<div class="step-block" id="step4" onclick="toggleStep('step4-content')">
    Step 4 ‚Äî Reference Alignment (BWA)
</div>
<div class="step-content" id="step4-content">
<div class="box">Start container: <strong>BWA</strong></div>

<button class="copy-btn" onclick="copyText('cmd4')">Copy</button>
<pre id="cmd4" class="language-bash"><code>bwa index MN908947.3.fna
bwa mem -t 2 -R "@RG\tID:SRR15571424\tSM:SRR15571424\tPL:illumina" \
MN908947.3.fna SRR15571424_1_val_1.fq.gz SRR15571424_2_val_2.fq.gz > aln.sam</code></pre>
</div>

<!-- STEP 5 BLOCK -->
<div class="step-block" id="step5" onclick="toggleStep('step5-content')">
    Step 5 ‚Äî BAM Processing (SAMtools)
</div>
<div class="step-content" id="step5-content">
<div class="box">Start container: <strong>SAMtools</strong></div>

<button class="copy-btn" onclick="copyText('cmd5')">Copy</button>
<pre id="cmd5" class="language-bash"><code>samtools view -S -b aln.sam > aln.bam
samtools sort aln.bam -o aln.sorted.bam
samtools index aln.sorted.bam</code></pre>
</div>

<!-- STEP 6 BLOCK -->
<div class="step-block" id="step6" onclick="toggleStep('step6-content')">
    Step 6 ‚Äî Variant Calling (BCFtools)
</div>
<div class="step-content" id="step6-content">
<div class="box">Start container: <strong>BCFtools</strong></div>

<button class="copy-btn" onclick="copyText('cmd6')">Copy</button>
<pre id="cmd6" class="language-bash"><code>bcftools mpileup -f MN908947.3.fna -Ou aln.sorted.bam > raw.bcf
bcftools call -mv -Ov --ploidy 1 raw.bcf > variants.vcf</code></pre>
</div>

<!-- STEP 7 BLOCK -->
<div class="step-block" id="step7" onclick="toggleStep('step7-content')">
    Step 7 ‚Äî Variant Annotation (SnpEff)
</div>
<div class="step-content" id="step7-content">
<div class="box">Start container: <strong>SnpEff</strong></div>

<button class="copy-btn" onclick="copyText('cmd7')">Copy</button>
<pre id="cmd7" class="language-bash"><code>/snpEff/scripts/buildDbNcbi.sh MN908947.3
java -jar snpEff.jar ann MN908947.3 variants.vcf > annotated.vcf</code></pre>
</div>

<!-- TOOL DOCUMENTATION -->
<h2 id="docs">Tool Documentation</h2>
<ul>
<li><a href="https://github.com/ncbi/sra-tools" target="_blank">SRA Toolkit</a></li>
<li><a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/" target="_blank">FastQC</a></li>
<li><a href="https://www.bioinformatics.babraham.ac.uk/projects/trim_galore/" target="_blank">Trim Galore</a></li>
<li><a href="https://github.com/lh3/bwa" target="_blank">BWA</a></li>
<li><a href="https://www.htslib.org/" target="_blank">SAMtools</a></li>
<li><a href="https://samtools.github.io/bcftools/" target="_blank">BCFtools</a></li>
<li><a href="https://pcingola.github.io/SnpEff/" target="_blank">SnpEff</a></li>
</ul>

</div>

<!-- JAVASCRIPT -->
<script>
function toggleStep(id) {
    const block = document.getElementById(id);
    block.style.display = block.style.display === "block" ? "none" : "block";
}

function copyText(id) {
    navigator.clipboard.writeText(document.getElementById(id).innerText);
}

function openStepFromSidebar(stepId) {
    const content = document.getElementById(stepId + "-content");
    if (content) content.style.display = "block";
    const header = document.getElementById(stepId);
    if (header) header.scrollIntoView({ behavior:"smooth" });
}
</script>

</body>
</html>


<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<title>SARS-CoV-2 Variant Calling Tutorial ‚Äî ICE-Cloud</title>

<!-- ============================
     Prism.js (Syntax Highlighting)
=============================== -->
<link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-bash.min.js"></script>

<!-- ============================
     Global Styles
=============================== -->
<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #ffffff;
    line-height: 1.6;
}

/* Sticky Header */
header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: 58px;
    background: #0b63a5;
    color: white;
    display: flex;
    align-items: center;
    padding: 0 18px;
    z-index: 1000;
    font-size: 18px;
    justify-content: space-between;
}

header .menu-btn {
    display: none;
    font-size: 26px;
    cursor: pointer;
    padding: 8px;
}

/* Sidebar (Desktop) */
#sidebar {
    position: fixed;
    top: 58px;
    left: 0;
    width: 270px;
    bottom: 0;
    background: #f3f7fa;
    overflow-y: auto;
    border-right: 1px solid #d6e1eb;
    padding: 18px;
}

#sidebar h3 {
    margin-top: 0;
    color: #063b63;
}

#sidebar .collapsible-header {
    font-weight: bold;
    cursor: pointer;
    margin-top: 14px;
    color: #0b63a5;
}

#sidebar ul {
    list-style: none;
    padding-left: 14px;
    margin-top: 6px;
}

#sidebar a {
    text-decoration: none;
    color: #063b63;
}

#sidebar a:hover {
    text-decoration: underline;
}

/* Sidebar ‚Äî Mobile slide-in */
#sidebar-mobile-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.55);
    z-index: 998;
}

#sidebar.mobile-active {
    left: 0 !important;
}

/* Main Content */
#content {
    margin-left: 290px;
    padding: 90px 40px 40px;
}

/* Collapsible Step Blocks */
.step-block {
    border-left: 4px solid #0b63a5;
    background: #e8f2ff;
    padding: 12px 14px;
    margin-bottom: 10px;
    cursor: pointer;
    font-weight: bold;
    color: #063b63;
    border-radius: 4px;
}

.step-content {
    display: none;
    margin-bottom: 20px;
}

/* Copy Button */
.copy-btn {
    background: #0b63a5;
    color: white;
    padding: 6px 12px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    float: right;
}

.copy-btn.copied {
    background: #1ea650 !important;
}

/* Workflow Diagram */
.workflow {
    display: flex;
    gap: 14px;
    flex-wrap: nowrap;
    overflow-x: auto;
    padding: 10px 0;
}

.workflow .wf-card {
    background: #e8f1fb;
    border: 2px solid #0b63a5;
    padding: 12px 16px;
    border-radius: 10px;
    text-align: center;
    min-width: 130px;
    font-size: 15px;
}

.workflow .arrow {
    font-size: 26px;
    align-self: center;
}

/* Prism */
pre[class*="language-"] {
    border-radius: 8px;
    padding: 14px;
}

/* Mobile Responsive */
@media (max-width: 900px) {

    header .menu-btn {
        display: block;
    }

    #sidebar {
        left: -320px;
        width: 260px;
        transition: left 0.25s ease;
    }

    #sidebar-mobile-overlay {
        display: block;
        visibility: hidden;
        opacity: 0;
        transition: opacity 0.25s ease;
    }

    #sidebar.mobile-active ~ #sidebar-mobile-overlay {
        visibility: visible;
        opacity: 1;
    }

    #content {
        margin-left: 0;
        padding: 100px 20px;
    }
}
</style>

</head>


<body>

<!-- Sticky Header -->
<header>
    <div class="menu-btn" onclick="toggleSidebar()">‚ò∞</div>
    SARS-CoV-2 Variant Calling Tutorial
</header>

<!-- Sidebar -->
<div id="sidebar">
    <h3>Contents</h3>

    <div class="collapsible-header">Introduction</div>
    <ul>
        <li><a href="#intro">Intro Overview</a></li>
        <li><a href="#objective">Objective</a></li>
        <li><a href="#workflow">Workflow Diagram</a></li>
    </ul>

    <div class="collapsible-header">Pipeline Steps</div>
    <ul>
        <li><a href="#step1">Step 1 ‚Äî Data Preparation</a></li>
        <li><a href="#step2">Step 2 ‚Äî FastQC</a></li>
        <li><a href="#step3">Step 3 ‚Äî Trimming</a></li>
        <li><a href="#step4">Step 4 ‚Äî Alignment</a></li>
        <li><a href="#step5">Step 5 ‚Äî BAM Processing</a></li>
        <li><a href="#step6">Step 6 ‚Äî Variant Calling</a></li>
        <li><a href="#step7">Step 7 ‚Äî Annotation</a></li>
    </ul>

    <div class="collapsible-header">Tool Documentation</div>
    <ul>
        <li><a href="#docs">Reference Links</a></li>
    </ul>
</div>

<div id="sidebar-mobile-overlay" onclick="toggleSidebar()"></div>

<!-- Main Content Begins -->
<div id="content">
<!-- ============================
     Introduction
=============================== -->
<h2 id="intro">Introduction</h2>
<p>
Next-generation sequencing (NGS) technology has transformed disease surveillance and diagnostics.  
It has been crucial in tracking emerging SARS-CoV-2 mutations affecting viral evolution, transmissibility, and vaccine response.  
ICE-Cloud, developed by C-DAC Pune, provides a unified HPC environment for data storage, analysis, and sharing.
</p>

<h2 id="workflow">Workflow Diagram</h2>
<div class="workflow">
    <div class="wf-card">üì•<br>Download</div>
    <div class="arrow">‚ûú</div>

    <div class="wf-card">üîç<br>FastQC</div>
    <div class="arrow">‚ûú</div>

    <div class="wf-card">‚úÇÔ∏è<br>Trim</div>
    <div class="arrow">‚ûú</div>

    <div class="wf-card">üß¨<br>BWA</div>
    <div class="arrow">‚ûú</div>

    <div class="wf-card">üßπ<br>SAMtools</div>
    <div class="arrow">‚ûú</div>

    <div class="wf-card">üß™<br>BCFtools</div>
    <div class="arrow">‚ûú</div>

    <div class="wf-card">üß†<br>SnpEff</div>
</div>

<h2 id="objective">Objective</h2>
<p>
To perform complete reference-based mapping and variant calling using ICE-Cloud, including:  
<strong>Quality check ‚Üí Trimming ‚Üí Alignment ‚Üí BAM processing ‚Üí Variant calling ‚Üí Annotation.</strong>
</p>

<br>

<!-- ============================
     Step 1
=============================== -->
<div class="step-block" onclick="toggleStep('step1-content')">
Step 1 ‚Äî Data Preparation
</div>
<div id="step1-content" class="step-content">

<p class="box">
Instructions:<br>
Home ‚Üí Images ‚Üí Search ‚Äúsratoolkit‚Äù<br>
CPU: 2<br>
Memory: 8 GB
</p>

<button class="copy-btn" data-target="cmd1">Copy</button>
<pre class="language-bash" id="cmd1">
prefetch SRR15571424
fasterq-dump SRR15571424 -S -e 2
gzip fastq/SRR15571424_1.fastq
gzip fastq/SRR15571424_2.fastq
</pre>
</div>

<!-- ============================
     Step 2
=============================== -->
<div class="step-block" onclick="toggleStep('step2-content')">
Step 2 ‚Äî Quality Check (FastQC)
</div>
<div id="step2-content" class="step-content">

<p class="box">
Container: fastqc<br>
CPU: 2<br>
Memory: 8 GB
</p>

<button class="copy-btn" data-target="cmd2">Copy</button>
<pre class="language-bash" id="cmd2">
cp -r /drive/public/ICE_Workshop/AIC_CCMB/var_call_tutorial .
cd var_call_tutorial
fastqc --threads 5 SRR15571424_1.fastq.gz SRR15571424_2.fastq.gz
ls -lrth
</pre>
</div>

<!-- ============================
     Step 3
=============================== -->
<div class="step-block" onclick="toggleStep('step3-content')">
Step 3 ‚Äî Read Trimming (Trim Galore)
</div>
<div id="step3-content" class="step-content">

<p class="box">
Container: trim_galore<br>
CPU: 2<br>
Memory: 8 GB
</p>

<button class="copy-btn" data-target="cmd3">Copy</button>
<pre class="language-bash" id="cmd3">
cd var_call_tutorial
trim_galore --fastqc --paired SRR15571424_1.fastq.gz SRR15571424_2.fastq.gz
ls -lrth
</pre>
</div>

<!-- ============================
     Step 4
=============================== -->
<div class="step-block" onclick="toggleStep('step4-content')">
Step 4 ‚Äî Reference Alignment (BWA)
</div>
<div id="step4-content" class="step-content">

<p class="box">
Container: bwa<br>
CPU: 2<br>
Memory: 8 GB
</p>

<button class="copy-btn" data-target="cmd4">Copy</button>
<pre class="language-bash" id="cmd4">
cd var_call_tutorial
bwa index MN908947.3.fna
bwa mem -t 2 -R "@RG    ID:SRR15571424  SM:SRR15571424  PL:illumina  LB:lib1  PU:unit1" \
    -V -M -o SRR15571424.sam MN908947.3.fna \
    SRR15571424_1_val_1.fq.gz SRR15571424_2_val_2.fq.gz
ls -lrth
</pre>
</div>

<!-- ============================
     Step 5
=============================== -->
<div class="step-block" onclick="toggleStep('step5-content')">
Step 5 ‚Äî BAM Processing (SAMtools)
</div>
<div id="step5-content" class="step-content">

<p class="box">
Container: samtools<br>
CPU: 2<br>
Memory: 8 GB
</p>

<button class="copy-btn" data-target="cmd5">Copy</button>
<pre class="language-bash" id="cmd5">
samtools view -S -b SRR15571424.sam -o SRR15571424.bam --threads 5
samtools sort SRR15571424.bam -o SRR15571424_sorted.bam --threads 5
samtools index SRR15571424_sorted.bam
samtools view -b -F 4 SRR15571424_sorted.bam > SRR15571424_mapped.bam
samtools view -b -f 4 SRR15571424_sorted.bam > SRR15571424_unmapped.bam
samtools flagstat SRR15571424_sorted.bam
ls -lrth
</pre>
</div>

<!-- ============================
     Step 6
=============================== -->
<div class="step-block" onclick="toggleStep('step6-content')">
Step 6 ‚Äî Variant Calling (BCFtools)
</div>
<div id="step6-content" class="step-content">

<p class="box">
Container: bcftools<br>
CPU: 2<br>
Memory: 8 GB
</p>

<button class="copy-btn" data-target="cmd6">Copy</button>
<pre class="language-bash" id="cmd6">
bcftools mpileup -f MN908947.3.fna -Ou --threads 5 SRR15571424_sorted.bam -o SRR15571424.bcf
bcftools call -mv -Ov --ploidy 1 --threads 2 SRR15571424.bcf -o SRR15571424.vcf
ls -lrth
</pre>
</div>

<!-- ============================
     Step 7
=============================== -->
<div class="step-block" onclick="toggleStep('step7-content')">
Step 7 ‚Äî Variant Annotation (SnpEff)
</div>
<div id="step7-content" class="step-content">

<p class="box">
Container: SnpEff<br>
CPU: 2<br>
Memory: 8 GB
</p>

<button class="copy-btn" data-target="cmd7">Copy</button>
<pre class="language-bash" id="cmd7">
/snpEff/scripts/buildDbNcbi.sh MN908947.3
java -jar /snpEff/snpEff.jar ann -v MN908947.3 SRR15571424.vcf \
    -csvStats SRR15571424_stat.csv -htmlStats SRR15571424_stat.html \
    > SRR15571424_ann.vcf

cat SRR15571424_ann.vcf | grep "missense_variant"
cat SRR15571424_ann.vcf | grep "MODERATE"
cat SRR15571424_ann.vcf | grep "LOW"
</pre>
</div>

<!-- ============================
     Documentation
=============================== -->
<h2 id="docs">Tool Documentation</h2>
<ul>
<li><a href="https://github.com/ncbi/sra-tools" target="_blank">SRA Toolkit</a></li>
<li><a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/" target="_blank">FastQC</a></li>
<li><a href="https://www.bioinformatics.babraham.ac.uk/projects/trim_galore/" target="_blank">Trim Galore</a></li>
<li><a href="https://github.com/lh3/bwa" target="_blank">BWA</a></li>
<li><a href="https://www.htslib.org/" target="_blank">SAMtools</a></li>
<li><a href="https://samtools.github.io/bcftools/" target="_blank">BCFtools</a></li>
<li><a href="https://pcingola.github.io/SnpEff/" target="_blank">SnpEff</a></li>
</ul>

<br><br>

<footer style="text-align:center; padding:20px; color:#666;">
Created for ICE-Cloud users ‚Ä¢ Variant Calling Tutorial
</footer>

</div> <!-- end content -->

<!-- ============================
     JavaScript Logic
=============================== -->
<script>
// Sidebar (Mobile)
function toggleSidebar() {
    const sb = document.getElementById("sidebar");
    sb.classList.toggle("mobile-active");
}

// Collapsible Step Blocks
function toggleStep(id) {
    const block = document.getElementById(id);
    block.style.display = (block.style.display === "block") ? "none" : "block";
}

// Copy Buttons
document.querySelectorAll(".copy-btn").forEach(btn => {
    btn.addEventListener("click", () => {
        const id = btn.dataset.target;
        const text = document.getElementById(id).innerText;

        navigator.clipboard.writeText(text).then(() => {
            btn.classList.add("copied");
            btn.innerText = "Copied!";
            setTimeout(() => {
                btn.classList.remove("copied");
                btn.innerText = "Copy";
            }, 1400);
        });
    });
});
</script>

</body>
</html>


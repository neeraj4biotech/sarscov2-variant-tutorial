<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>SARS-CoV-2 Variant Calling Tutorial ‚Äî ICE-Cloud</title>
<style>
body {font-family: Arial, sans-serif; margin: 0; padding: 0; line-height:1.6;}
#sidebar {width: 260px; background:#f4f4f4; height:100vh; position:fixed; overflow:auto; padding:20px; border-right:1px solid #ccc;}
#content {margin-left:280px; padding:30px;}
h2 {color:#0b63a5; margin-top:40px;}
.box {background:#e8f2ff; border-left:4px solid #0b63a5; padding:10px 14px; margin:12px 0; white-space:pre-line;}
pre {background:#111827; color:#e5e7eb; padding:12px; border-radius:6px; overflow:auto;}
.copy-btn {background:#0b63a5; color:white; border:none; padding:6px 10px; margin-bottom:6px; cursor:pointer; border-radius:4px;}
.workflow {text-align:center; margin:20px 0;}
</style>
</head>
<body>
<div id="sidebar">
<h3>Contents</h3>
<ul>
<li><a href="#intro">Introduction</a></li>
<li><a href="#objective">Objective</a></li>
<li><a href="#step1">Step 1 ‚Äî Data Preparation</a></li>
<li><a href="#step2">Step 2 ‚Äî FastQC</a></li>
<li><a href="#step3">Step 3 ‚Äî Trimming</a></li>
<li><a href="#step4">Step 4 ‚Äî Alignment</a></li>
<li><a href="#step5">Step 5 ‚Äî BAM Processing</a></li>
<li><a href="#step6">Step 6 ‚Äî Variant Calling</a></li>
<li><a href="#step7">Step 7 ‚Äî Annotation</a></li>
<li><a href="#docs">Tool Documentation</a></li>
</ul>
</div>
<div id="content">
<h2 id="intro">Introduction</h2>
<p>Next-generation sequencing (NGS) technology has transformed disease surveillance and diagnostics. A major application has been tracking emerging SARS-CoV-2 mutations that inform public health decisions. ICE-Cloud, developed by C-DAC Pune, enables high-throughput genomic workflows with unified data storage and compute access.</p>

<h2>Workflow Diagram</h2>
<div class="workflow">üì• ‚ûú üîç ‚ûú ‚úÇÔ∏è ‚ûú üß¨ ‚ûú üßπ ‚ûú üß™ ‚ûú üß†</div>

<h2 id="objective">Objective</h2>
<p>To perform reference-based mapping and variant calling of SARS-CoV-2 sequencing data using ICE-Cloud, including QC, trimming, alignment, variant calling, and annotation.</p>

<h2 id="step1">Step 1 ‚Äî Data Preparation</h2>
<div class="box">Instructions to start ICE job container:
Home ‚Üí Images ‚Üí Image Library ‚Üí Search "sratoolkit"
Memory Allocation: 8 GB
CPU Allocation: 2
Connect to terminal after the job is running.</div>

<button class="copy-btn" onclick="copyText('cmd1')">Copy</button>
<pre id="cmd1">prefetch SRR15571424
fasterq-dump SRR15571424 -S -e 2
gzip fastq/SRR15571424_1.fastq
gzip fastq/SRR15571424_2.fastq</pre>

<h2 id="step2">Step 2 ‚Äî Quality Check (FastQC)</h2>
<div class="box">Instructions:
Start container: fastqc
Memory: 8 GB
CPU: 2</div>

<button class="copy-btn" onclick="copyText('cmd2')">Copy</button>
<pre id="cmd2">cp -r /drive/public/ICE_Workshop/AIC_CCMB/var_call_tutorial .
cd var_call_tutorial
fastqc --threads 5 SRR15571424_1.fastq.gz SRR15571424_2.fastq.gz
ls -lrth</pre>

<h2 id="step3">Step 3 ‚Äî Read Trimming (Trim Galore)</h2>
<div class="box">Start container: trim_galore
Memory: 8 GB
CPU: 2</div>

<button class="copy-btn" onclick="copyText('cmd3')">Copy</button>
<pre id="cmd3">cd var_call_tutorial
trim_galore --fastqc --paired SRR15571424_1.fastq.gz SRR15571424_2.fastq.gz
ls -lrth</pre>

<h2 id="step4">Step 4 ‚Äî Reference Alignment (BWA)</h2>
<div class="box">Start container: bwa
Memory: 8 GB
CPU: 2</div>

<button class="copy-btn" onclick="copyText('cmd4')">Copy</button>
<pre id="cmd4">cd var_call_tutorial
bwa index MN908947.3.fna
bwa mem -t 2 -R "@RG	ID:SRR15571424	SM:SRR15571424	PL:illumina	LB:lib1	PU:unit1" -V -M -o SRR15571424.sam MN908947.3.fna SRR15571424_1_val_1.fq.gz SRR15571424_2_val_2.fq.gz
ls -lrth</pre>

<h2 id="step5">Step 5 ‚Äî BAM Processing (SAMtools)</h2>
<div class="box">Start container: samtools
Memory: 8 GB
CPU: 2</div>

<button class="copy-btn" onclick="copyText('cmd5')">Copy</button>
<pre id="cmd5">samtools view -S -b SRR15571424.sam -o SRR15571424.bam --threads 5
samtools sort SRR15571424.bam -o SRR15571424_sorted.bam --threads 5
samtools index SRR15571424_sorted.bam
samtools view -b -F 4 SRR15571424_sorted.bam > SRR15571424_mapped.bam
samtools view -b -f 4 SRR15571424_sorted.bam > SRR15571424_unmapped.bam
samtools flagstat SRR15571424_sorted.bam
ls -lrth</pre>

<h2 id="step6">Step 6 ‚Äî Variant Calling (BCFtools)</h2>
<div class="box">Start container: bcftools
Memory: 8 GB
CPU: 2</div>

<button class="copy-btn" onclick="copyText('cmd6')">Copy</button>
<pre id="cmd6">bcftools mpileup -f MN908947.3.fna -Ou --threads 5 SRR15571424_sorted.bam -o SRR15571424.bcf
bcftools call -mv -Ov --ploidy 1 --threads 2 SRR15571424.bcf -o SRR15571424.vcf
ls -lrth</pre>

<h2 id="step7">Step 7 ‚Äî Variant Annotation (SnpEff)</h2>
<div class="box">Start container: snpeff
Memory: 8 GB
CPU: 2</div>

<button class="copy-btn" onclick="copyText('cmd7')">Copy</button>
<pre id="cmd7">/snpEff/scripts/buildDbNcbi.sh MN908947.3
java -jar /snpEff/snpEff.jar ann -v MN908947.3 SRR15571424.vcf -csvStats SRR15571424_stat.csv -htmlStats SRR15571424_stat.html > SRR15571424_ann.vcf

cat SRR15571424_ann.vcf | grep "missense_variant"
cat SRR15571424_ann.vcf | grep "MODERATE"
cat SRR15571424_ann.vcf | grep "LOW"</pre>

<h2 id="docs">Tool Documentation</h2>
<ul>
<li>SRA Toolkit ‚Äî https://github.com/ncbi/sra-tools</li>
<li>FastQC ‚Äî https://www.bioinformatics.babraham.ac.uk/projects/fastqc/</li>
<li>Trim Galore ‚Äî https://www.bioinformatics.babraham.ac.uk/projects/trim_galore/</li>
<li>BWA ‚Äî https://github.com/lh3/bwa</li>
<li>SAMtools ‚Äî https://www.htslib.org/</li>
<li>BCF

